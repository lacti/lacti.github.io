<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="lacti">

	<meta name="description" content="pintos 환경 구축 01 Apr 2008 os Pintos를 구동시키기 위해서는 먼저 가상 에뮬레이터가 필요하다. Open source 중에 대표적으로 Bochs와 QEMU가 있는데, 설치법이 과제 문서에 기술되어있는 Bochs를 선택하여 설치하였다. Bochs는 Open Source 프로젝트로 Sourceforge에서 그 소스를 다운받아 컴파일하여 설치할 수 있다. 파일을 받기 위해서 Sourceforge에 lynx로 접속하여 bochs-2.3.tar.gz를 다운 받았다. tar.gz 압축이므로 tar xvzf를 이용하여 압축을 풀었다. ~$ tar xvzf bochs-2.3.tar.gz 원격으로 터미널을 통해 진행할 예정이기 때문에 bochs가 terminal이 가능하고 gui가 없어도 동작할 수 있도록 컴파일해서 설치해야 했다. 따라서 configure 옵션에 --with-term과 --with-nogui를 주었다. 또 과제 문서에서 제시한 바와 같이 gdb debugging을 위해 --enable-gdb-stub을 옵션으로 주었다. ~/bochs-2.3$ ./configure --with-term --with-nogui --enable-gdb-stub 그 다음에 bochs를 make하고 설치하기 위해 make와 make install 명령을 수행했다. make install은 모든 사용자가 사용하는 전역 위치에 bochs를 설치하기..." />

	<meta http-equiv="date" content="Tuesday, 01  2008 00:00:00 GMT" />

	<meta name="keywords" content="os,-pub" />

	<meta name="robots" content="INDEX,FOLLOW" />
	<title>pintos 환경 구축</title>
	<link href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css" rel="stylesheet">
	<link href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css" rel="stylesheet">
	<link href="/css/markdownpad-github.css" rel="stylesheet">
	<link href="/css/syntax.css" rel="stylesheet">
	<link href="/css/blog-post.css" rel="stylesheet">
	<link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>
	<div id="head">
		<div class="pure-g">
			<div class="pure-u-1 pure-u-md-1-2">
				<a href="/" title="home"><i class="fa fa-home fa-lg"></i></a>
				<a href="/about/" title="about"><i class="fa fa-male fa-lg"></i></a>
				<a href="/archives/" title="archives"><i class="fa fa-file-text-o fa-lg"></i></a>
				<a href="/tags/" title="tags"><i class="fa fa-tags fa-lg"></i></a>
			</div>
			<div class="pure-u-1 pure-u-md-1-2 text-right">
				<a href="https://github.com/lacti" title="github" rel="nofollow"><i class="fa fa-github fa-lg"></i></a>
				<a href="https://twitter.com/lacti" title="twitter" rel="nofollow"><i class="fa fa-twitter fa-lg"></i></a>
				<a href="http://www.slideshare.net/lactrious/presentations" title="slideshare" rel="nofollow"><i class="fa fa-toggle-right fa-lg"></i></a>
				<a href="http://www.linkedin.com/pub/jaeyoung-choi/99/243/861" title="linkedin" rel="nofollow"><i class="fa fa-linkedin fa-lg"></i></a>
				<a href="https://facebook.com/lactrious" title="facebook" rel="nofollow"><i class="fa fa-facebook fa-lg"></i></a>
				<a href="/atom.xml" title="atom" rel="nofollow"><i class="fa fa-rss fa-lg"></i></a>
			</div>
		</div>
	</div>
	<div class="container">
		<div class="pure-g">
			<div class="pure-u-1">
				<h1 class="page-title">pintos 환경 구축</h1>
				<p class="page-date">01 Apr 2008</p>
				<p class="page-tags">
				
				
					<code class="tag"><a href="/tags/#os">os</a></code>
				
				
				
				
				</p>
				
				<div class="content">
				<p>Pintos를 구동시키기 위해서는 먼저 가상 에뮬레이터가 필요하다. Open source 중에 대표적으로 Bochs와 QEMU가 있는데, 설치법이 과제 문서에 기술되어있는 Bochs를 선택하여 설치하였다.</p>

<ul>
<li>Bochs는 Open Source 프로젝트로 Sourceforge에서 그 소스를 다운받아 컴파일하여 설치할 수 있다. 파일을 받기 위해서 Sourceforge에 lynx로 접속하여 bochs-2.3.tar.gz를 다운 받았다.</li>
<li>tar.gz 압축이므로 tar xvzf를 이용하여 압축을 풀었다.</li>
</ul>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~<span class="nv">$ </span>tar xvzf bochs-2.3.tar.gz
</code></pre></div>
<p>원격으로 터미널을 통해 진행할 예정이기 때문에 bochs가 terminal이 가능하고 gui가 없어도 동작할 수 있도록 컴파일해서 설치해야 했다. 따라서 configure 옵션에 <code>--with-term</code>과 <code>--with-nogui</code>를 주었다. 또 과제 문서에서 제시한 바와 같이 gdb debugging을 위해 <code>--enable-gdb-stub</code>을 옵션으로 주었다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/bochs-2.3<span class="nv">$ </span>./configure --with-term --with-nogui --enable-gdb-stub
</code></pre></div>
<p>그 다음에 bochs를 make하고 설치하기 위해 make와 make install 명령을 수행했다. make install은 모든 사용자가 사용하는 전역 위치에 bochs를 설치하기 때문에 일반 사용자 권한으로는 설치가 안된다. 따라서 과제 문서가 제시한 대로 root 권한으로 설치를 수행하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/bochs-2.3<span class="nv">$ </span>make<span class="p">;</span> sudo make install
</code></pre></div>
<p>bochs의 설치가 완료 되었다. 정상 동작을 확인하기 위해 <code>bochs --help</code>를 수행하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/bochs-2.3<span class="nv">$ </span>bochs --help
<span class="o">========================================================================</span>
                        Bochs x86 Emulator 2.3
              Build from CVS snapshot on August 27, <span class="nv">2006</span>
<span class="o">========================================================================</span>
Usage: bochs <span class="o">[</span>flags<span class="o">]</span> <span class="o">[</span>bochsrc options<span class="o">]</span>

  -n               no configuration file
  -f configfile    specify configuration file
  -q               quick start <span class="o">(</span>skip configuration interface<span class="o">)</span>
  --help           display this <span class="nb">help </span>and <span class="nb">exit</span>

For information on Bochs configuration file arguments, see the
bochsrc section in the user documentation or the man page of bochsrc.
00000000000i<span class="o">[</span>CTRL <span class="o">]</span> quit_sim called with <span class="nb">exit </span>code 0
</code></pre></div>
<p>다음으로 pintos를 실행하기 위해 pintos를 다운로드 받았다. pintos는 구글 검색을 통해 다운로드 주소가 <a href="http://www.stanford.edu/class/cs140/projects/pintos/pintos.tar.gz">http://www.stanford.edu/class/cs140/projects/pintos/pintos.tar.gz</a>에 있음을 찾아내서 wget 명령으로 다운로드 받았다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="nv">$ </span>wget http://www.stanford.edu/class/cs140/projects/pintos/pintos.tar.gz
</code></pre></div>
<p>역시 tar.gz 압축이므로 tar xvzf로 압축을 해제하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="nv">$ </span>tar xvzf pintos.tar.gz
</code></pre></div>
<p>과제 문서에 제시된 대로 pintos/src/threads로 이동하여 make를 수행하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd </span>pintos/src/threads
~/pintos/src/threads<span class="nv">$ </span>make
</code></pre></div>
<p>make 수행이 <code>undefined references to &#39;__stack_chk_fail&#39; follow</code>이라는 에러에 의해 중단되었다. 이를 해결하기 위해 구글을 검색하여 <a href="http://ubuntuforums.org/showthread.php?t=303541">다음의 레퍼런스</a>를 얻었다. 이 포럼에서 권고하는 대로 make 설정에서 CFLAGS의 값에 <code>-fno-stack-protector</code> 옵션을 추가해주기 위해 편집기 vi를 사용하여 Make.vars에 <code>CFLAGS += -fno-stack-protector</code>를 추가해 주었다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads<span class="nv">$ </span>vi Make.vars
</code></pre></div>
<p>기존에 컴파일한 것들을 제거하기 위해 make clean을 수행한 후 make를 수행하여 빌드를 마쳤다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads<span class="nv">$ </span>make clean
~/pintos/src/threads<span class="nv">$ </span>make
</code></pre></div>
<p>Pintos를 수행하기 전에 편의를 위해서 다음과 같은 alias를 작성하였다. 이 alias를 ~/.bashrc에 추가하여 bash이 열릴 때마다 alias가 자동으로 등록되도록 했다. 그리고 어디에서나 pintos가 실행될 수 있도록 pintos 실행 파일이 있는 곳을 PATH에 추가하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads<span class="nv">$ </span>vi ~/.bashrc
</code></pre></div>
<p>추가한 내용은 아래와 같다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:~/pintos/src/utils/

<span class="nb">alias </span><span class="nv">pinv</span><span class="o">=</span><span class="s1">&#39;pintos -v -- run&#39;</span>
<span class="nb">alias </span><span class="nv">pint</span><span class="o">=</span><span class="s1">&#39;pintos -t -- run&#39;</span>

<span class="nb">alias </span><span class="nv">pinvg</span><span class="o">=</span><span class="s1">&#39;pintos --gdb -v -- run&#39;</span>
<span class="nb">alias </span><span class="nv">pintg</span><span class="o">=</span><span class="s1">&#39;pintos --gdb -t -- run&#39;</span>
</code></pre></div>
<p>추가한 내용을 적용시키기 위해서 source를 수행했다. 수행한 후, PATH가 적용되었는지 확인하기 위해서 설정된 PATH를 출력하도록 했다. 다음과 같이 추가된 것을 확인할 수 있었다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads<span class="nv">$ </span><span class="nb">source</span> ~/.bashrc
~/pintos/src/threads<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$PATH</span>
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/home/lacti/pintos/src/utils
</code></pre></div>
<p>pintos를 수행하기 위해 threads의 build 디렉토리로 이동하였다. 미리 작성해둔 alias를 이용하여 간단하게 pintos threads를 구동하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads/build<span class="nv">$ </span>pinv alarm-multiple
Writing <span class="nb">command </span>line to /tmp/w6Pkbt7Upa.dsk...
warning: can<span class="err">&#39;</span>t find squish-pty, so terminal input will fail
bochs –q
</code></pre></div>
<p>위의 alias에 정의되어 있듯이 <code>pinv alarm-multiple</code>을 수행했을 경우 실제 수행되는 명령어는 <code>pintos –v –- run alarm-multiple</code>이다.</p>

<p>결과는 제대로 나오지만 warning이 꺼림직했기 때문에 <code>squish-pty</code>를 빌드하기로 하였다. <code>~/pintos/src/utils</code>로 이동하여 make를 수행하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads/build<span class="nv">$ </span><span class="nb">cd</span> ../../utils/
~/pintos/src/utils<span class="nv">$ </span>make
</code></pre></div>
<p><code>squish-pty</code>를 비롯한 몇 개의 파일들이 빌드되었고, 정상 작동함을 확인하기 위해 다시 pintos를 구동시켜보았다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/utils<span class="nv">$ </span><span class="nb">cd</span> ../threads/build
~/pintos/src/threads/build<span class="nv">$ </span>pinv alarm-multiple
Writing <span class="nb">command </span>line to /tmp/UcIb0NhSWJ.dsk...
squish-pty bochs -q
<span class="o">========================================================================</span>
                        Bochs x86 Emulator 2.3
              Build from CVS snapshot on August 27, <span class="nv">2006</span>
<span class="o">========================================================================</span>
00000000000i<span class="o">[</span>     <span class="o">]</span> reading configuration from bochsrc.txt
00000000000i<span class="o">[</span>     <span class="o">]</span> installing nogui module as the Bochs GUI
00000000000i<span class="o">[</span>     <span class="o">]</span> using log file bochsout.txt
Kernel <span class="nb">command </span>line: run alarm-multiple
Pintos booting with 4,096 kB RAM...
375 pages available in kernel pool.
374 pages available in user pool.
Calibrating timer...  204,600 loops/s.
Boot complete.
Executing <span class="s1">&#39;alarm-multiple&#39;</span>:
<span class="o">(</span>alarm-multiple<span class="o">)</span> begin
<span class="o">(</span>alarm-multiple<span class="o">)</span> Creating 5 threads to sleep 7 <span class="nb">times </span>each.
<span class="o">(</span>alarm-multiple<span class="o">)</span> Thread 0 sleeps 10 ticks each <span class="nb">time</span>,
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1 sleeps 20 ticks each <span class="nb">time</span>, and so on.
<span class="o">(</span>alarm-multiple<span class="o">)</span> If successful, product of iteration count and
<span class="o">(</span>alarm-multiple<span class="o">)</span> sleep duration will appear in nondescending order.
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>1, <span class="nv">product</span><span class="o">=</span>10
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>2, <span class="nv">product</span><span class="o">=</span>20
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>1, <span class="nv">product</span><span class="o">=</span>20
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>3, <span class="nv">product</span><span class="o">=</span>30
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>1, <span class="nv">product</span><span class="o">=</span>30
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>4, <span class="nv">product</span><span class="o">=</span>40
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>2, <span class="nv">product</span><span class="o">=</span>40
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>1, <span class="nv">product</span><span class="o">=</span>40
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>5, <span class="nv">product</span><span class="o">=</span>50
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>1, <span class="nv">product</span><span class="o">=</span>50
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>2, <span class="nv">product</span><span class="o">=</span>60
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>6, <span class="nv">product</span><span class="o">=</span>60
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>3, <span class="nv">product</span><span class="o">=</span>60
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 0: <span class="nv">duration</span><span class="o">=</span>10, <span class="nv">iteration</span><span class="o">=</span>7, <span class="nv">product</span><span class="o">=</span>70
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>2, <span class="nv">product</span><span class="o">=</span>80
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>4, <span class="nv">product</span><span class="o">=</span>80
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>3, <span class="nv">product</span><span class="o">=</span>90
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>2, <span class="nv">product</span><span class="o">=</span>100
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>5, <span class="nv">product</span><span class="o">=</span>100
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>6, <span class="nv">product</span><span class="o">=</span>120
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>4, <span class="nv">product</span><span class="o">=</span>120
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>3, <span class="nv">product</span><span class="o">=</span>120
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 1: <span class="nv">duration</span><span class="o">=</span>20, <span class="nv">iteration</span><span class="o">=</span>7, <span class="nv">product</span><span class="o">=</span>140
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>3, <span class="nv">product</span><span class="o">=</span>150
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>5, <span class="nv">product</span><span class="o">=</span>150
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>4, <span class="nv">product</span><span class="o">=</span>160
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>6, <span class="nv">product</span><span class="o">=</span>180
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>4, <span class="nv">product</span><span class="o">=</span>200
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>5, <span class="nv">product</span><span class="o">=</span>200
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 2: <span class="nv">duration</span><span class="o">=</span>30, <span class="nv">iteration</span><span class="o">=</span>7, <span class="nv">product</span><span class="o">=</span>210
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>6, <span class="nv">product</span><span class="o">=</span>240
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>5, <span class="nv">product</span><span class="o">=</span>250
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 3: <span class="nv">duration</span><span class="o">=</span>40, <span class="nv">iteration</span><span class="o">=</span>7, <span class="nv">product</span><span class="o">=</span>280
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>6, <span class="nv">product</span><span class="o">=</span>300
<span class="o">(</span>alarm-multiple<span class="o">)</span> thread 4: <span class="nv">duration</span><span class="o">=</span>50, <span class="nv">iteration</span><span class="o">=</span>7, <span class="nv">product</span><span class="o">=</span>350
<span class="o">(</span>alarm-multiple<span class="o">)</span> end
Execution of <span class="s1">&#39;alarm-multiple&#39;</span> complete.
</code></pre></div>
<p>위와 같이 정상 작동함을 확인할 수 있었다. 종료를 위해 Ctrl + C를 누르면 다음과 같이 interrupt를 받으며 종료된다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="o">========================================================================</span>
Bochs is exiting with the following message:
<span class="o">[</span>     <span class="o">]</span> SIGNAL 2 <span class="nv">caught</span>
<span class="o">========================================================================</span>
</code></pre></div>
<p><code>pintos –t</code> 옵션을 사용하지 않고 <code>pintos –v</code> 옵션을 사용한 이유는 <code>pintos –t</code> 옵션을 사용하여 pintos를 구동시키게 되면 수행 후에 Ctrl + C로 interrupt를 걸어도 bochs가 수행을 종료하지 않고 메모리에 계속 남아있기 때문이다. 따라서 추가적으로 <code>kill -9</code> 등을 사용하여 종료해주어야 하므로 좀 더 편리한 <code>pintos –v</code> 옵션을 사용하였다. 물론 <code>pintos –t</code> 옵션을 사용하면 잠깐 지나가는 BIOS 화면을 볼 수 있다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="nv">$ </span>ps -ef <span class="p">|</span>grep bochs
lacti    11939     1 99 02:19 pts/0    00:01:01 bochs -q
lacti    11941  3985  0 02:20 pts/0    00:00:00 grep bochs
</code></pre></div>
<p>다음 과정인 gdb를 수행하기 위해 gdb를 설치하였다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~<span class="nv">$ </span>sudo apt-get install gdb
</code></pre></div>
<p>PuTTY를 하나 더 켜서 pintos를 gdb모드로 실행시켰다. 글자를 조금이라도 적게 치기 위해서 이미 위에서 alias를 정의해 놓았다. v 옵션으로 gdb를 수행하므로 pinvg이다. 따라서 과제 문서에서 제시한 대로 alarm-multiple를 수행하려면 <code>pinvg alarm-multiple</code>이라고 하면 되고, 실제 명령은 <code>pintos –-gdb –v – run alarm-multiple</code>이다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~<span class="nv">$ </span><span class="nb">cd </span>pintos/src/threads/build/
~/pintos/src/threads/build<span class="nv">$ </span>pinvg alarm-multiple
</code></pre></div>
<p>그러면 다음과 같이 bochs가 gdb의 접속을 기다리며 수행을 멈춘다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~/pintos/src/threads/build<span class="nv">$ </span>pinvg alarm-multiple
Writing <span class="nb">command </span>line to /tmp/RArahIMk8f.dsk...
squish-pty bochs -q
<span class="o">========================================================================</span>
                        Bochs x86 Emulator 2.3
              Build from CVS snapshot on August 27, <span class="nv">2006</span>
<span class="o">========================================================================</span>
00000000000i<span class="o">[</span>     <span class="o">]</span> reading configuration from bochsrc.txt
00000000000i<span class="o">[</span>     <span class="o">]</span> Enabled gdbstub
00000000000i<span class="o">[</span>     <span class="o">]</span> installing nogui module as the Bochs GUI
00000000000i<span class="o">[</span>     <span class="o">]</span> using log file bochsout.txt
Waiting <span class="k">for </span>gdb connection on localhost:1234
</code></pre></div>
<p>다른 PuTTY에서 gdb를 켜서 원격 디버깅을 시작한다. 어차피 localhost이므로 <code>remote localhost:1234</code>로 연결하면 된다. 그러면 다음과 같이 접속이 이루어진다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">~<span class="nv">$ </span>gdb
GNU gdb 6.6-debian
Copyright <span class="o">(</span>C<span class="o">)</span> 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type <span class="s2">&quot;show copying&quot;</span> to see the conditions.
There is absolutely no warranty <span class="k">for </span>GDB.  Type <span class="s2">&quot;show warranty&quot;</span> <span class="k">for </span>details.
This GDB was configured as <span class="s2">&quot;i486-linux-gnu&quot;</span>.
<span class="o">(</span>gdb<span class="o">)</span> target remote localhost:1234
Remote debugging using localhost:1234
warning: unrecognized item <span class="s2">&quot;ENN&quot;</span> in <span class="s2">&quot;qSupported&quot;</span> response
0x0000fff0 in ?? <span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div>
<p>여기서 <code>continue</code> 명령인 <code>c</code>를 누르면 pintos가 계속 진행된다. Ctrl + C를 눌러서 수행을 중단할 수 있다. 그리고 <code>kill</code> 명령을 이용하여 debugging을 중단하고 pintos의 수행을 중단할 수 있다. gdb에서 작업을 끝내려면 <code>quit</code> 명령을 이용해서 나가면 된다.</p>

<p>다음과 같이 <code>kill</code> 명령으로 수행 중인 pintos를 종료할 수 있다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="o">(</span>gdb<span class="o">)</span> c
Continuing.

Program received signal 0, Signal 0.
0xc0101660 in ?? <span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">kill</span>
Kill the program being debugged? <span class="o">(</span>y or n<span class="o">)</span> y
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div>
<p>그러면 pintos에서는 다음과 같이 Debugger의 종료 요청에 의한 종료를 수행하게 된다.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">Execution of <span class="s1">&#39;alarm-multiple&#39;</span> complete.
<span class="o">========================================================================</span>
Bochs is exiting with the following message:
<span class="o">[</span>     <span class="o">]</span> Debugger asked us to <span class="nv">quit</span>

<span class="o">========================================================================</span>
</code></pre></div>
				</div>

				<div class="pure-g page-navigator">
					<div class="pure-u-1-2">
					
						<a href="/2008/04/01/gdb-simple-help/" title="gdb 간단 사용법 정리">&laquo; gdb 간단 사용법 정리</a>
					
					</div>
					<div class="pure-u-1-2 text-right">
					
						<a href="/2008/04/01/pintos-boot/" title="pintos 부팅 과정">&raquo; pintos 부팅 과정</a>
					
					</div>
				</div>

				<!-- the comments -->
				<div id="disqus_container">
					<div id="disqus_thread"></div>
					<script type="text/javascript">
						var disqus_shortname = 'lacti';
						(function() {
							var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
							dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
							(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
						})();
					</script>
					<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
				</div>
			</div>
		</div>

		
		<footer>
			<hr />
			<div id="footer-menu">
				<a href="#top" title="go to top"><i class="fa fa-chevron-up fa-lg"></i></a>
				<div class="mobile-only">
					<a href="/" title="home"><i class="fa fa-home fa-lg"></i></a>
					<a href="/about/" title="about"><i class="fa fa-male fa-lg"></i></a>
					<a href="/archives/" title="archives"><i class="fa fa-file-text-o fa-lg"></i></a>
					<a href="/tags/" title="tags"><i class="fa fa-tags fa-lg"></i></a>
					<a href="https://github.com/lacti" title="github" rel="nofollow"><i class="fa fa-github fa-lg"></i></a>
					<a href="https://twitter.com/lacti" title="twitter" rel="nofollow"><i class="fa fa-twitter fa-lg"></i></a>
					<a href="http://www.slideshare.net/lactrious/presentations" title="slideshare" rel="nofollow"><i class="fa fa-toggle-right fa-lg"></i></a>
					<a href="http://www.linkedin.com/pub/jaeyoung-choi/99/243/861" title="linkedin" rel="nofollow"><i class="fa fa-linkedin fa-lg"></i></a>
					<a href="https://facebook.com/lactrious" title="facebook" rel="nofollow"><i class="fa fa-facebook fa-lg"></i></a>
					<a href="/atom.xml" title="atom"><i class="fa fa-rss fa-lg"></i></a>
				</div>
			</div>
			<p class="text-right">
				<em>© 2008-2015 Jaeyoung Choi</em>
			</p>
		</footer>
	</div>
	<!-- /.container -->
	<!-- ga -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-51932355-1', 'lacti.me');
		ga('send', 'pageview');
	</script>
</body>
</html>
